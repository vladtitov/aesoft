function onObjectClick(n){$(n.target.parentNode).children("div").toggle(300)}function render(n){var i="",t;for(t in n)typeof n[t]=="object"?(i+='<div class="lobject package" style="display:none" ><h3>'+t+"<\/h3>",i+=render(n[t])+"<\/div>"):i+='<div id="litem" style="display:none">'+t+": <font color=blue>"+n[t]+"<\/font><\/div>";return i}function renderWeather(n){var t="";return t+='<div style="font-size: xx-large; margin-left:-3px; margin-top:15px; ">'+n.tempc+"&deg;C<\/div>",t+='<div><img src="'+n.img+'"/><\/div>',t+="<div>",t+="<li>"+n.loc+"<\/li>",t+="<li>"+n.descr+"<\/li>",t+="<li>Visibility:"+n.vis_km+"Km<\/li>",t+="<li>Pressure:"+n.press_mb+"Mb<\/li>",t+"<\/div>"}function showWeather(n){$("#weather").html(renderWeather(n))}function onWeather(n){if(typeof n=="object"&&n.hasOwnProperty("current_observation")){var t=n.current_observation,i={img:t.icon_url,loc:t.display_location.full,tempc:t.temp_c,tempf:t.temp_f,descr:t.weather,press_mb:t.pressure_mb,vis_km:t.visibility_km};showWeather(i)}else console.log("EEEEEERRRRRRRRRRORRRRRRRRRRR: "+n)}function getWeather(n){var t="http://api.wunderground.com/api/5b9eb056e60d346d/conditions/q/"+n+".json";$.ajax({dataType:"jsonp",url:t,data:null,success:onWeather})}function populateLocation(n){$("#location").html('<div class="lobject package" ><h3>Yor Location<\/h3>'+render(n.location)+"<\/div>");$(".lobject >h3").on("click",onObjectClick);var t=n.location.lat+","+n.location.lon;getWeather(t)}function onResult1(n){n.substr(0,11)=='"not exists'?getLocation():n.substr(0,10)=='{"response'?populateLocation(JSON.parse(n)):console.log("ERRRRROORRR  onResult \n"+n)}function onFail(n){console.log("onFail"),console.log(n)}function onSaveResult(n){console.log("onSaveResult"+n)}function fCallback(n){$.post("/Services/?a=location.save",n,onSaveResult),onResult1(JSON.stringify(n))}function getLocation(){$.ajax({dataType:"jsonp",url:"http://api.wunderground.com/api/5b9eb056e60d346d/geolookup/q/autoip.json",data:null,success:fCallback})}$(document).ready(function(){$.ajax("/Services/?a=location.get").done(onResult1).fail(onFail)});
